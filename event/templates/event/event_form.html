<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.0.0/dist/tailwind.min.css" rel="stylesheet">
    <title>{{ form_title }} Event</title>
</head>
<body class="bg-green-50 flex items-center justify-center min-h-screen">

<div class="bg-white rounded-lg shadow-lg sm:max-w-md w-full mx-auto mt-10 p-8">
    <h1 class="text-2xl font-bold mb-6 text-green-700 text-center">{{ form_title }} Event</h1>

    <form id="eventForm" method="post" class="space-y-6">
        {% csrf_token %}
        
        <div class="relative">
            <label for="event-name" class="block text-green-800 mb-2">Event Name</label>
            <input type="text" id="event-name" name="name" placeholder="Event Name" class="rounded-lg border border-green-300 w-full py-2 px-4 bg-green-50 text-green-900 placeholder-green-400 shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent" value="{{ form.name.value|default_if_none:'' }}"/>
        </div>

        <div class="relative">
            <label for="event-description" class="block text-green-800 mb-2">Description</label>
            <textarea id="event-description" name="description" placeholder="Description" class="rounded-lg border border-green-300 w-full py-2 px-4 bg-green-50 text-green-900 placeholder-green-400 shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent">{{ form.description.value|default_if_none:'' }}</textarea>
        </div>

        <div class="relative">
            <label for="event-location" class="block text-green-800 mb-2">Location</label>
            <input type="text" id="event-location" name="location" placeholder="Location" class="rounded-lg border border-green-300 w-full py-2 px-4 bg-green-50 text-green-900 placeholder-green-400 shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent" value="{{ form.location.value|default_if_none:'' }}"/>
        </div>

        <div class="relative">
            <label for="event-date" class="block text-green-800 mb-2">Date</label>
            <input type="datetime-local" id="event-date" name="date" class="rounded-lg border border-green-300 w-full py-2 px-4 bg-green-50 text-green-900 placeholder-green-400 shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent" value="{{ form.date.value|date:'Y-m-d H:i'|default_if_none:'' }}"/>
        </div>

        <div class="flex justify-end mt-4">
            <a href="{% url 'event_list' %}" class="text-green-600 hover:underline mr-4">Cancel</a>
            <button type="submit" id="submitBtn" class="py-2 px-4 bg-green-500 hover:bg-green-600 text-white rounded-md">{{ form_button_text }}</button>
        </div>
    </form>

    <div id="formErrors" class="text-red-500 mt-4 hidden"></div>
</div>

<script>
    document.getElementById('eventForm').addEventListener('submit', function(e) {
        e.preventDefault();
        let form = this;
        let formData = new FormData(form);
        let url = form.action;

        fetch(url, {
            method: 'POST',
            body: formData,
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Mengarahkan ke halaman daftar acara setelah sukses membuat acara
                window.location.href = "{% url 'event_list' %}";
            } else {
                let errorDiv = document.getElementById('formErrors');
                errorDiv.innerHTML = '';
                for (let key in data.errors) {
                    errorDiv.innerHTML += `<p>${data.errors[key]}</p>`;
                }
                errorDiv.classList.remove('hidden');
            }
        });
    });
</script>
</body>
</html>
